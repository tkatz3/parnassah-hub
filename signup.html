<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Join ParnassaHub — Sign Up</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              50: '#ebf3ff', 100: '#d6e8ff', 200: '#add0ff',
              300: '#85b8ff', 400: '#5c9ef5', 500: '#2877C9',
              600: '#1d62aa', 700: '#154d8b',
            }
          },
          fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    body { font-family: 'Inter', system-ui, sans-serif; }
    input:focus, textarea:focus, select:focus { outline:none; }
    .role-card { transition: border-color .2s, box-shadow .2s, background .2s; }
    .role-card.selected { border-color: #2877C9; background: #ebf3ff; box-shadow: 0 0 0 3px rgba(40,119,201,.15); }
    .step-dot { transition: background .3s, transform .3s; }
    .field-wrap:focus-within label { color: #2877C9; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900 antialiased min-h-screen flex flex-col">

<!-- TOP BAR -->
<header class="bg-white border-b border-gray-100 py-4 px-6 flex items-center justify-between">
  <a href="index.html">
    <img src="parnassah hub.png" alt="ParnassaHub" class="h-14 w-auto" />
  </a>
  <p class="text-sm text-gray-500">Already have an account? <a href="#" onclick="showSignIn()" class="text-brand-500 hover:text-brand-600 font-medium">Sign in</a></p>
</header>

<!-- MAIN -->
<main class="flex-1 flex items-start justify-center py-10 px-4">
  <div class="w-full max-w-lg">

    <!-- ERROR BANNER -->
    <div id="error-banner" class="hidden mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-700"></div>

    <!-- SIGN IN SCREEN -->
    <div id="screen-signin" class="hidden">
      <div class="text-center mb-8">
        <h1 class="text-2xl font-extrabold text-gray-900 mb-2">Welcome back</h1>
        <p class="text-gray-500 text-sm">Sign in to your ParnassaHub account</p>
      </div>
      <div class="bg-white rounded-2xl border border-gray-200 p-6 space-y-4">
        <div class="field-wrap">
          <label class="block text-xs font-medium text-gray-600 mb-1.5">Email Address</label>
          <input id="signin-email" type="email" placeholder="you@example.com" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
        </div>
        <div class="field-wrap">
          <label class="block text-xs font-medium text-gray-600 mb-1.5">Password</label>
          <input id="signin-password" type="password" placeholder="Your password" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
        </div>
        <button onclick="doSignIn()" id="signin-btn" class="w-full py-3.5 bg-brand-500 hover:bg-brand-600 text-white font-semibold text-sm rounded-xl transition">
          Sign In
        </button>
        <p class="text-center text-xs text-gray-500">Don't have an account? <a href="#" onclick="showSignUp()" class="text-brand-500 font-medium">Sign up</a></p>
      </div>
    </div>

    <!-- SCREEN 1: ROLE SELECTION -->
    <div id="screen-role">
      <div class="text-center mb-8">
        <h1 class="text-2xl sm:text-3xl font-extrabold text-gray-900 mb-2">Join ParnassaHub</h1>
        <p class="text-gray-500 text-sm">Who are you signing up as?</p>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
        <button id="roleSeeker" onclick="selectRole('seeker')" class="role-card group border-2 border-gray-200 rounded-2xl p-6 text-left hover:border-brand-300 transition cursor-pointer">
          <div class="w-12 h-12 rounded-xl bg-brand-50 flex items-center justify-center mb-4 group-hover:bg-brand-100 transition">
            <svg class="w-6 h-6 text-brand-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
          </div>
          <h3 class="font-bold text-gray-900 mb-1">Job Seeker</h3>
          <p class="text-sm text-gray-500 leading-snug">I'm looking for work and want to browse &amp; apply to jobs.</p>
        </button>

        <button id="roleEmployer" onclick="selectRole('employer')" class="role-card group border-2 border-gray-200 rounded-2xl p-6 text-left hover:border-brand-300 transition cursor-pointer">
          <div class="w-12 h-12 rounded-xl bg-brand-50 flex items-center justify-center mb-4 group-hover:bg-brand-100 transition">
            <svg class="w-6 h-6 text-brand-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg>
          </div>
          <h3 class="font-bold text-gray-900 mb-1">Employer</h3>
          <p class="text-sm text-gray-500 leading-snug">I represent a company and want to post jobs &amp; find candidates.</p>
        </button>
      </div>

      <button id="continueBtn" onclick="continueToForm()" disabled
        class="w-full py-3.5 bg-brand-500 text-white font-semibold text-sm rounded-xl transition disabled:opacity-40 disabled:cursor-not-allowed hover:bg-brand-600">
        Continue
      </button>
    </div>

    <!-- SCREEN 2A: JOB SEEKER FORM -->
    <div id="screen-seeker" class="hidden">
      <div class="flex items-center justify-center gap-2 mb-8">
        <div id="dot1s" class="step-dot w-2 h-2 rounded-full bg-brand-500"></div>
        <div id="dot2s" class="step-dot w-2 h-2 rounded-full bg-gray-200"></div>
        <div id="dot3s" class="step-dot w-2 h-2 rounded-full bg-gray-200"></div>
      </div>

      <div class="text-center mb-8">
        <button onclick="goBack()" class="inline-flex items-center gap-1.5 text-xs text-gray-500 hover:text-gray-700 mb-4">
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg> Back
        </button>
        <h1 class="text-2xl font-extrabold text-gray-900 mb-1">Create your profile</h1>
        <p class="text-sm text-gray-500">Step <span id="seekerStep">1</span> of 3</p>
      </div>

      <!-- Step 1: Basic Info -->
      <div id="seeker-step-1" class="space-y-4">
        <div class="bg-white rounded-2xl border border-gray-200 p-6 space-y-4">
          <h3 class="text-sm font-semibold text-gray-700">Personal Information</h3>
          <div class="grid grid-cols-2 gap-3">
            <div class="field-wrap">
              <label class="block text-xs font-medium text-gray-600 mb-1.5">First Name *</label>
              <input id="s-first" type="text" placeholder="Moshe" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
            </div>
            <div class="field-wrap">
              <label class="block text-xs font-medium text-gray-600 mb-1.5">Last Name *</label>
              <input id="s-last" type="text" placeholder="Cohen" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
            </div>
          </div>
          <div class="field-wrap">
            <label class="block text-xs font-medium text-gray-600 mb-1.5">Email Address *</label>
            <input id="s-email" type="email" placeholder="moshe@example.com" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
          </div>
          <div class="field-wrap">
            <label class="block text-xs font-medium text-gray-600 mb-1.5">Phone Number</label>
            <input id="s-phone" type="tel" placeholder="(908) 555-0123" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
          </div>
          <div class="field-wrap">
            <label class="block text-xs font-medium text-gray-600 mb-1.5">Password *</label>
            <input id="s-password" type="password" placeholder="Min. 8 characters" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
          </div>
        </div>
        <button onclick="seekerNextStep(2)" class="w-full py-3.5 bg-brand-500 hover:bg-brand-600 text-white font-semibold text-sm rounded-xl transition">Continue →</button>
      </div>

      <!-- Step 2: Preferences -->
      <div id="seeker-step-2" class="space-y-4 hidden">
        <div class="bg-white rounded-2xl border border-gray-200 p-6 space-y-5">
          <h3 class="text-sm font-semibold text-gray-700">Job Preferences</h3>

          <div>
            <label class="block text-xs font-medium text-gray-600 mb-2">Job Categories of Interest</label>
            <div class="grid grid-cols-2 gap-2">
              <label class="flex items-center gap-2 text-xs text-gray-700 cursor-pointer p-2 rounded-lg border border-gray-200 hover:border-brand-300 hover:bg-brand-50/50 transition"><input type="checkbox" class="pref-cat w-3.5 h-3.5" style="accent-color:#2877C9" value="Accounting &amp; Auditing" />Accounting &amp; Auditing</label>
              <label class="flex items-center gap-2 text-xs text-gray-700 cursor-pointer p-2 rounded-lg border border-gray-200 hover:border-brand-300 hover:bg-brand-50/50 transition"><input type="checkbox" class="pref-cat w-3.5 h-3.5" style="accent-color:#2877C9" value="Admin Support" />Admin Support</label>
              <label class="flex items-center gap-2 text-xs text-gray-700 cursor-pointer p-2 rounded-lg border border-gray-200 hover:border-brand-300 hover:bg-brand-50/50 transition"><input type="checkbox" class="pref-cat w-3.5 h-3.5" style="accent-color:#2877C9" value="Finance &amp; Banking" />Finance &amp; Banking</label>
              <label class="flex items-center gap-2 text-xs text-gray-700 cursor-pointer p-2 rounded-lg border border-gray-200 hover:border-brand-300 hover:bg-brand-50/50 transition"><input type="checkbox" class="pref-cat w-3.5 h-3.5" style="accent-color:#2877C9" value="Sales &amp; Marketing" />Sales &amp; Marketing</label>
              <label class="flex items-center gap-2 text-xs text-gray-700 cursor-pointer p-2 rounded-lg border border-gray-200 hover:border-brand-300 hover:bg-brand-50/50 transition"><input type="checkbox" class="pref-cat w-3.5 h-3.5" style="accent-color:#2877C9" value="Real Estate" />Real Estate</label>
              <label class="flex items-center gap-2 text-xs text-gray-700 cursor-pointer p-2 rounded-lg border border-gray-200 hover:border-brand-300 hover:bg-brand-50/50 transition"><input type="checkbox" class="pref-cat w-3.5 h-3.5" style="accent-color:#2877C9" value="Operations" />Operations</label>
              <label class="flex items-center gap-2 text-xs text-gray-700 cursor-pointer p-2 rounded-lg border border-gray-200 hover:border-brand-300 hover:bg-brand-50/50 transition"><input type="checkbox" class="pref-cat w-3.5 h-3.5" style="accent-color:#2877C9" value="Education" />Education</label>
              <label class="flex items-center gap-2 text-xs text-gray-700 cursor-pointer p-2 rounded-lg border border-gray-200 hover:border-brand-300 hover:bg-brand-50/50 transition"><input type="checkbox" class="pref-cat w-3.5 h-3.5" style="accent-color:#2877C9" value="Human Resources" />Human Resources</label>
            </div>
          </div>

          <div>
            <label class="block text-xs font-medium text-gray-600 mb-1.5">Preferred Locations</label>
            <select id="pref-locs" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 focus:outline-none transition appearance-none" multiple size="5">
              <option>Greater Lakewood Area</option><option>Linden NJ</option><option>Monsey</option>
              <option>New Jersey</option><option>New York City</option><option>Newark</option>
              <option>Northern New Jersey</option><option>Remote</option><option selected>Union County</option><option>Worldwide</option>
            </select>
            <p class="text-xs text-gray-400 mt-1.5">Hold Ctrl / Cmd to select multiple</p>
          </div>

          <div>
            <label class="block text-xs font-medium text-gray-600 mb-2">Looking for</label>
            <div class="flex flex-wrap gap-2">
              <label class="flex items-center gap-1.5 cursor-pointer text-xs border border-gray-200 rounded-full px-3 py-1.5 hover:border-brand-300 hover:bg-brand-50 transition"><input type="checkbox" class="pref-type w-3 h-3" style="accent-color:#2877C9" value="Full Time" /> Full Time</label>
              <label class="flex items-center gap-1.5 cursor-pointer text-xs border border-gray-200 rounded-full px-3 py-1.5 hover:border-brand-300 hover:bg-brand-50 transition"><input type="checkbox" class="pref-type w-3 h-3" style="accent-color:#2877C9" value="Part-Time" /> Part-Time</label>
              <label class="flex items-center gap-1.5 cursor-pointer text-xs border border-gray-200 rounded-full px-3 py-1.5 hover:border-brand-300 hover:bg-brand-50 transition"><input type="checkbox" class="pref-type w-3 h-3" style="accent-color:#2877C9" value="Commission" /> Commission</label>
              <label class="flex items-center gap-1.5 cursor-pointer text-xs border border-gray-200 rounded-full px-3 py-1.5 hover:border-brand-300 hover:bg-brand-50 transition"><input type="checkbox" class="pref-type w-3 h-3" style="accent-color:#2877C9" value="Volunteer" /> Volunteer</label>
            </div>
          </div>
        </div>

        <div class="flex gap-3">
          <button onclick="seekerNextStep(1)" class="flex-1 py-3.5 border border-gray-200 text-gray-600 font-semibold text-sm rounded-xl hover:bg-gray-50 transition">← Back</button>
          <button id="seeker-submit-btn" onclick="registerSeeker()" class="flex-1 py-3.5 bg-brand-500 hover:bg-brand-600 text-white font-semibold text-sm rounded-xl transition">Create Account →</button>
        </div>
      </div>

      <!-- Step 3: Success -->
      <div id="seeker-step-3" class="space-y-4 hidden">
        <div class="bg-white rounded-2xl border border-gray-200 p-8 text-center">
          <div class="w-16 h-16 rounded-full bg-green-50 flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
          </div>
          <h2 class="text-xl font-bold text-gray-900 mb-2">You're all set!</h2>
          <p class="text-sm text-gray-500 mb-6">Your profile has been created. Start exploring opportunities in the community.</p>
          <a href="find-jobs.html" class="w-full inline-flex items-center justify-center py-3.5 bg-brand-500 hover:bg-brand-600 text-white font-semibold text-sm rounded-xl transition mb-3">Browse Jobs</a>
          <a href="jobseeker-dashboard.html" class="w-full inline-flex items-center justify-center py-3 border border-gray-200 text-gray-600 text-sm font-medium rounded-xl hover:bg-gray-50 transition">Go to My Dashboard</a>
        </div>
      </div>
    </div>

    <!-- SCREEN 2B: EMPLOYER FORM -->
    <div id="screen-employer" class="hidden">
      <div class="flex items-center justify-center gap-2 mb-8">
        <div id="dot1e" class="step-dot w-2 h-2 rounded-full bg-brand-500"></div>
        <div id="dot2e" class="step-dot w-2 h-2 rounded-full bg-gray-200"></div>
        <div id="dot3e" class="step-dot w-2 h-2 rounded-full bg-gray-200"></div>
      </div>

      <div class="text-center mb-8">
        <button onclick="goBack()" class="inline-flex items-center gap-1.5 text-xs text-gray-500 hover:text-gray-700 mb-4">
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg> Back
        </button>
        <h1 class="text-2xl font-extrabold text-gray-900 mb-1">Register your company</h1>
        <p class="text-sm text-gray-500">Step <span id="employerStep">1</span> of 3</p>
      </div>

      <!-- Step 1: Company Info -->
      <div id="employer-step-1" class="space-y-4">
        <div class="bg-white rounded-2xl border border-gray-200 p-6 space-y-4">
          <h3 class="text-sm font-semibold text-gray-700">Company Details</h3>
          <div class="field-wrap">
            <label class="block text-xs font-medium text-gray-600 mb-1.5">Company Name *</label>
            <input id="e-company" type="text" placeholder="Acme Corp Ltd." class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
          </div>
          <div class="field-wrap">
            <label class="block text-xs font-medium text-gray-600 mb-1.5">Company Website</label>
            <input id="e-website" type="url" placeholder="https://www.company.com" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
          </div>
          <div class="field-wrap">
            <label class="block text-xs font-medium text-gray-600 mb-1.5">Industry *</label>
            <select id="e-industry" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 focus:outline-none transition appearance-none">
              <option value="" disabled selected>Select an industry…</option>
              <option>Accounting &amp; Finance</option><option>Education</option><option>Healthcare</option>
              <option>Human Resources</option><option>Marketing &amp; Advertising</option>
              <option>Operations &amp; Logistics</option><option>Real Estate</option>
              <option>Retail &amp; Sales</option><option>Religious / Non-Profit</option>
              <option>Technology</option><option>Transportation</option><option>Other</option>
            </select>
          </div>
          <div class="field-wrap">
            <label class="block text-xs font-medium text-gray-600 mb-1.5">Company Description</label>
            <textarea id="e-desc" placeholder="Brief description of your company and culture…" rows="3" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition resize-none"></textarea>
          </div>
        </div>
        <button onclick="employerNextStep(2)" class="w-full py-3.5 bg-brand-500 hover:bg-brand-600 text-white font-semibold text-sm rounded-xl transition">Continue →</button>
      </div>

      <!-- Step 2: Contact Person -->
      <div id="employer-step-2" class="space-y-4 hidden">
        <div class="bg-white rounded-2xl border border-gray-200 p-6 space-y-4">
          <h3 class="text-sm font-semibold text-gray-700">Contact Person</h3>
          <div class="grid grid-cols-2 gap-3">
            <div class="field-wrap">
              <label class="block text-xs font-medium text-gray-600 mb-1.5">First Name *</label>
              <input id="e-first" type="text" placeholder="Yosef" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
            </div>
            <div class="field-wrap">
              <label class="block text-xs font-medium text-gray-600 mb-1.5">Last Name *</label>
              <input id="e-last" type="text" placeholder="Levy" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
            </div>
          </div>
          <div class="field-wrap">
            <label class="block text-xs font-medium text-gray-600 mb-1.5">Business Email *</label>
            <input id="e-email" type="email" placeholder="yosef@company.com" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
          </div>
          <div class="field-wrap">
            <label class="block text-xs font-medium text-gray-600 mb-1.5">Phone Number</label>
            <input id="e-phone" type="tel" placeholder="(908) 555-0100" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
          </div>
          <div class="field-wrap">
            <label class="block text-xs font-medium text-gray-600 mb-1.5">Password *</label>
            <input id="e-password" type="password" placeholder="Min. 8 characters" class="w-full px-3.5 py-2.5 border border-gray-200 rounded-xl text-sm focus:border-brand-400 transition" />
          </div>
        </div>
        <div class="flex gap-3">
          <button onclick="employerNextStep(1)" class="flex-1 py-3.5 border border-gray-200 text-gray-600 font-semibold text-sm rounded-xl hover:bg-gray-50 transition">← Back</button>
          <button id="employer-submit-btn" onclick="registerEmployer()" class="flex-1 py-3.5 bg-brand-500 hover:bg-brand-600 text-white font-semibold text-sm rounded-xl transition">Create Account →</button>
        </div>
      </div>

      <!-- Step 3: Success -->
      <div id="employer-step-3" class="space-y-4 hidden">
        <div class="bg-white rounded-2xl border border-gray-200 p-8 text-center">
          <div class="w-16 h-16 rounded-full bg-brand-50 flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-brand-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5"/></svg>
          </div>
          <h2 class="text-xl font-bold text-gray-900 mb-2">Company registered!</h2>
          <p class="text-sm text-gray-500 mb-6">Your employer account is ready. Post your first job listing and connect with qualified candidates.</p>
          <a href="post-job.html" class="w-full inline-flex items-center justify-center py-3.5 bg-brand-500 hover:bg-brand-600 text-white font-semibold text-sm rounded-xl transition mb-3">Post Your First Job</a>
          <a href="employer-dashboard.html" class="w-full inline-flex items-center justify-center py-3 border border-gray-200 text-gray-600 text-sm font-medium rounded-xl hover:bg-gray-50 transition">Go to Employer Dashboard</a>
        </div>
      </div>
    </div>

  </div>
</main>

<footer class="text-center py-6 text-xs text-gray-400">
  &copy; 2025 ParnassaHub &middot; Volunteer-run &middot;
  <a href="about.html" class="hover:text-gray-600">About</a> &middot;
  Sponsored by <a href="https://omrgroup.net" class="hover:text-gray-600">ORTEK Group</a>
</footer>

<script src="js/supabase-client.js"></script>
<script>
  let currentRole = null

  function showError(msg) {
    const el = document.getElementById('error-banner')
    el.textContent = msg
    el.classList.remove('hidden')
    window.scrollTo(0,0)
  }
  function clearError() { document.getElementById('error-banner').classList.add('hidden') }

  function showSignIn() {
    document.getElementById('screen-role').classList.add('hidden')
    document.getElementById('screen-seeker').classList.add('hidden')
    document.getElementById('screen-employer').classList.add('hidden')
    document.getElementById('screen-signin').classList.remove('hidden')
  }
  function showSignUp() {
    document.getElementById('screen-signin').classList.add('hidden')
    document.getElementById('screen-role').classList.remove('hidden')
  }

  async function doSignIn() {
    clearError()
    const email    = document.getElementById('signin-email').value.trim()
    const password = document.getElementById('signin-password').value
    if (!email || !password) { showError('Please enter your email and password.'); return }
    const btn = document.getElementById('signin-btn')
    btn.textContent = 'Signing in…'; btn.disabled = true
    const { error } = await sb.auth.signInWithPassword({ email, password })
    if (error) { showError(error.message); btn.textContent = 'Sign In'; btn.disabled = false; return }
    const profile = await getCurrentProfile()
    window.location.href = profile?.role === 'employer' ? 'employer-dashboard.html' : 'jobseeker-dashboard.html'
  }

  function selectRole(role) {
    currentRole = role
    document.getElementById('roleSeeker').classList.toggle('selected', role === 'seeker')
    document.getElementById('roleEmployer').classList.toggle('selected', role === 'employer')
    document.getElementById('continueBtn').disabled = false
  }

  function continueToForm() {
    document.getElementById('screen-role').classList.add('hidden')
    if (currentRole === 'seeker') document.getElementById('screen-seeker').classList.remove('hidden')
    else document.getElementById('screen-employer').classList.remove('hidden')
  }

  function goBack() {
    document.getElementById('screen-seeker').classList.add('hidden')
    document.getElementById('screen-employer').classList.add('hidden')
    document.getElementById('screen-role').classList.remove('hidden')
  }

  let seekerCurrentStep = 1
  function seekerNextStep(step) {
    document.getElementById('seeker-step-' + seekerCurrentStep).classList.add('hidden')
    document.getElementById('seeker-step-' + step).classList.remove('hidden')
    document.getElementById('seekerStep').textContent = step
    for (let i = 1; i <= 3; i++) {
      const dot = document.getElementById('dot' + i + 's')
      dot.classList.toggle('bg-brand-500', i <= step)
      dot.classList.toggle('bg-gray-200', i > step)
      dot.style.transform = i === step ? 'scale(1.4)' : 'scale(1)'
    }
    seekerCurrentStep = step
  }

  let employerCurrentStep = 1
  function employerNextStep(step) {
    document.getElementById('employer-step-' + employerCurrentStep).classList.add('hidden')
    document.getElementById('employer-step-' + step).classList.remove('hidden')
    document.getElementById('employerStep').textContent = step
    for (let i = 1; i <= 3; i++) {
      const dot = document.getElementById('dot' + i + 'e')
      dot.classList.toggle('bg-brand-500', i <= step)
      dot.classList.toggle('bg-gray-200', i > step)
      dot.style.transform = i === step ? 'scale(1.4)' : 'scale(1)'
    }
    employerCurrentStep = step
  }

  async function registerSeeker() {
    clearError()
    const email    = document.getElementById('s-email').value.trim()
    const password = document.getElementById('s-password').value
    const first    = document.getElementById('s-first').value.trim()
    const last     = document.getElementById('s-last').value.trim()
    const phone    = document.getElementById('s-phone').value.trim()

    if (!first || !last || !email || !password) { showError('Please fill in all required fields.'); return }
    if (password.length < 8) { showError('Password must be at least 8 characters.'); return }

    const cats  = [...document.querySelectorAll('.pref-cat:checked')].map(el => el.value)
    const locs  = [...document.getElementById('pref-locs').selectedOptions].map(o => o.value)
    const types = [...document.querySelectorAll('.pref-type:checked')].map(el => el.value)

    const btn = document.getElementById('seeker-submit-btn')
    btn.textContent = 'Creating account…'; btn.disabled = true

    const { data, error } = await sb.auth.signUp({
      email, password,
      options: { data: { role: 'seeker' } }
    })
    if (error) { showError(error.message); btn.textContent = 'Create Account →'; btn.disabled = false; return }

    const uid = data.user.id
    await sb.from('profiles').update({ first_name: first, last_name: last, phone }).eq('id', uid)
    await sb.from('seeker_profiles').insert({
      user_id: uid,
      preferred_categories: cats.length ? cats : null,
      preferred_locations:  locs.length ? locs : null,
      preferred_types:      types.length ? types : null,
    })

    seekerNextStep(3)
  }

  async function registerEmployer() {
    clearError()
    const email    = document.getElementById('e-email').value.trim()
    const password = document.getElementById('e-password').value
    const first    = document.getElementById('e-first').value.trim()
    const last     = document.getElementById('e-last').value.trim()
    const phone    = document.getElementById('e-phone').value.trim()
    const company  = document.getElementById('e-company').value.trim()
    const website  = document.getElementById('e-website').value.trim()
    const industry = document.getElementById('e-industry').value
    const desc     = document.getElementById('e-desc').value.trim()

    if (!first || !last || !email || !password || !company) { showError('Please fill in all required fields.'); return }
    if (password.length < 8) { showError('Password must be at least 8 characters.'); return }

    const btn = document.getElementById('employer-submit-btn')
    btn.textContent = 'Creating account…'; btn.disabled = true

    const { data, error } = await sb.auth.signUp({
      email, password,
      options: { data: { role: 'employer' } }
    })
    if (error) { showError(error.message); btn.textContent = 'Create Account →'; btn.disabled = false; return }

    const uid = data.user.id
    await sb.from('profiles').update({ first_name: first, last_name: last, phone }).eq('id', uid)
    await sb.from('companies').insert({
      user_id: uid,
      name: company,
      website: website || null,
      industry: industry || null,
      description: desc || null,
    })

    employerNextStep(3)
  }

  // Handle ?role= query param
  const params = new URLSearchParams(window.location.search)
  const roleParam = params.get('role')
  if (roleParam === 'seeker')   { selectRole('seeker');   continueToForm() }
  if (roleParam === 'employer') { selectRole('employer'); continueToForm() }

  // Redirect if already logged in
  sb.auth.getUser().then(({ data: { user } }) => {
    if (user) getCurrentProfile().then(p => {
      if (p?.role === 'employer') window.location.href = 'employer-dashboard.html'
      else if (p) window.location.href = 'jobseeker-dashboard.html'
    })
  })
</script>
</body>
</html>
